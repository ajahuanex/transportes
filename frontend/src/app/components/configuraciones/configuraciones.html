<div class="configuraciones-container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <h1 class="title">
        <i class="fas fa-cogs"></i>
        Configuraciones del Sistema
      </h1>
      <p class="subtitle">Gestión centralizada de configuraciones para todos los módulos</p>
    </div>
    
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="exportarConfiguraciones()">
        <i class="fas fa-download"></i>
        Exportar
      </button>
      <button class="btn btn-primary" (click)="nuevaConfiguracion()">
        <i class="fas fa-plus"></i>
        Nueva Configuración
      </button>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filters-grid">
      <!-- Módulo -->
      <div class="filter-group">
        <label for="modulo">Módulo</label>
        <select 
          id="modulo" 
          class="form-control"
          (change)="actualizarFiltro('modulo', $event.target.value || undefined)"
        >
          <option value="">Todos los módulos</option>
          <option *ngFor="let modulo of modulos" [value]="modulo">
            {{ obtenerTextoModulo(modulo) }}
          </option>
        </select>
      </div>

      <!-- Tipo -->
      <div class="filter-group">
        <label for="tipo">Tipo</label>
        <select 
          id="tipo" 
          class="form-control"
          (change)="actualizarFiltro('tipo', $event.target.value || undefined)"
        >
          <option value="">Todos los tipos</option>
          <option *ngFor="let tipo of tipos" [value]="tipo">
            {{ obtenerTextoTipo(tipo) }}
          </option>
        </select>
      </div>

      <!-- Estado -->
      <div class="filter-group">
        <label for="estado">Estado</label>
        <select 
          id="estado" 
          class="form-control"
          (change)="actualizarFiltro('activo', $event.target.value === 'true' ? true : $event.target.value === 'false' ? false : undefined)"
        >
          <option value="">Todos los estados</option>
          <option value="true">Activo</option>
          <option value="false">Inactivo</option>
        </select>
      </div>

      <!-- Búsqueda -->
      <div class="filter-group">
        <label for="busqueda">Buscar</label>
        <input 
          type="text" 
          id="busqueda" 
          class="form-control"
          placeholder="Buscar por nombre..."
          (input)="actualizarFiltro('nombre', $event.target.value)"
        >
      </div>
    </div>

    <div class="filter-actions">
      <button class="btn btn-outline-secondary" (click)="limpiarFiltros()">
        <i class="fas fa-times"></i>
        Limpiar
      </button>
      <button class="btn btn-primary" (click)="aplicarFiltros()">
        <i class="fas fa-search"></i>
        Aplicar
      </button>
    </div>
  </div>

  <!-- Estadísticas -->
  <div class="stats-section">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-cogs"></i>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ currentTotal() }}</div>
          <div class="stat-label">Total Configuraciones</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon active">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ obtenerEstadisticas().activas }}</div>
          <div class="stat-label">Activas</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon inactive">
          <i class="fas fa-times-circle"></i>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ obtenerEstadisticas().inactivas }}</div>
          <div class="stat-label">Inactivas</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabla de Configuraciones -->
  <div class="table-section">
    <div class="table-header">
      <div class="table-info">
        <span class="results-count">
          Mostrando {{ (currentPaginaActual() - 1) * currentPorPagina() + 1 }} - 
          {{ Math.min(currentPaginaActual() * currentPorPagina(), currentTotal()) }} 
          de {{ currentTotal() }} configuraciones
        </span>
      </div>
      
      <div class="table-actions">
        <label for="porPagina">Por página:</label>
        <select 
          id="porPagina" 
          class="form-control-sm"
          [value]="currentPorPagina()"
          (change)="cambiarElementosPorPagina($event)"
        >
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="50">50</option>
        </select>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading-state">
      <div class="spinner"></div>
      <p>Cargando configuraciones...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading() && currentConfiguraciones().length === 0" class="empty-state">
      <i class="fas fa-cogs empty-icon"></i>
      <h3>No se encontraron configuraciones</h3>
      <p>No hay configuraciones que coincidan con los filtros aplicados.</p>
      <button class="btn btn-primary" (click)="limpiarFiltros()">
        Limpiar Filtros
      </button>
    </div>

    <!-- Table -->
    <div *ngIf="!isLoading() && currentConfiguraciones().length > 0" class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Módulo</th>
            <th>Tipo</th>
            <th>Items</th>
            <th>Estado</th>
            <th>Editable</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let configuracion of currentConfiguraciones()" class="table-row">
            <td class="config-name">
              <div class="name-content">
                <strong>{{ configuracion.nombre }}</strong>
                <small *ngIf="configuracion.descripcion" class="description">
                  {{ configuracion.descripcion }}
                </small>
              </div>
            </td>
            
            <td>
              <span class="badge badge-module">
                {{ obtenerTextoModulo(configuracion.modulo) }}
              </span>
            </td>
            
            <td>
              <span class="badge badge-type">
                {{ obtenerTextoTipo(configuracion.tipo) }}
              </span>
            </td>
            
            <td>
              <span class="items-count">
                {{ obtenerCantidadItems(configuracion) }} items
              </span>
            </td>
            
            <td>
              <span class="badge" [class]="obtenerClaseEstado(configuracion.activo)">
                {{ obtenerTextoEstado(configuracion.activo) }}
              </span>
            </td>
            
            <td>
              <span class="badge" [class]="configuracion.editable ? 'badge-success' : 'badge-warning'">
                {{ configuracion.editable ? 'Sí' : 'No' }}
              </span>
            </td>
            
            <td class="actions">
              <div class="action-buttons">
                <button 
                  class="btn btn-sm btn-outline-primary" 
                  (click)="verConfiguracion(configuracion.id)"
                  title="Ver detalles"
                >
                  <i class="fas fa-eye"></i>
                </button>
                
                <button 
                  *ngIf="configuracion.editable"
                  class="btn btn-sm btn-outline-secondary" 
                  (click)="editarConfiguracion(configuracion.id)"
                  title="Editar"
                >
                  <i class="fas fa-edit"></i>
                </button>
                
                <button 
                  class="btn btn-sm btn-outline-danger" 
                  (click)="eliminarConfiguracion(configuracion.id)"
                  title="Eliminar"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Paginación -->
    <div *ngIf="!isLoading() && currentConfiguraciones().length > 0" class="pagination-section">
      <div class="pagination-info">
        <span>
          Página {{ currentPaginaActual() }} de {{ Math.ceil(currentTotal() / currentPorPagina()) }}
        </span>
      </div>
      
      <div class="pagination-controls">
        <button 
          class="btn btn-sm btn-outline-secondary"
          [disabled]="currentPaginaActual() === 1"
          (click)="cambiarPagina(currentPaginaActual() - 1)"
        >
          <i class="fas fa-chevron-left"></i>
          Anterior
        </button>
        
        <div class="page-numbers">
          <button 
            *ngFor="let pagina of generarArrayPaginas()"
            class="btn btn-sm"
            [class]="pagina === currentPaginaActual() ? 'btn-primary' : 'btn-outline-secondary'"
            (click)="cambiarPagina(pagina)"
          >
            {{ pagina }}
          </button>
        </div>
        
        <button 
          class="btn btn-sm btn-outline-secondary"
          [disabled]="currentPaginaActual() >= Math.ceil(currentTotal() / currentPorPagina())"
          (click)="cambiarPagina(currentPaginaActual() + 1)"
        >
          Siguiente
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div> 